FilterForward

How to compile
FilterForward can be compiled by running cmake with the options -DUSE_CAFFE=true -DUSE_TENSORFLOW=true
See the wiki (https://github.com/viscloud/streamer/wiki)

How to run
In order to run FilterForward, you need the following
1. A base neural network (IE: caffe mobilenet) to generate feature vectors
2. A binary classifier (microclassifier) implemented in TensorFlow which takes a feature vector as input
3. A FilterForward configuration file

Generating the microclassifier

The microclassifier should be a binary classifier which takes as input a feature vector consisting of
a rectangular crop of the rows/columns of the activations generated by the base neural network.

1. The output of the microclassifier should be a probability between 0 and 1.
2. The input tensor should be named Placeholder, and the output tensor should be named probabilities.

The microclassifier has the same constraints as any other TensorFlow model used in Streamer in that it should be a "frozen" graph (weights and architecture in same file).

Creating the FilterForward configuration file

Each line in the FilterForward configuration file should either be:
1. A comma-separated list of strings indicating the configuration for a level in the hierarchy
or 
2. A comment prefixed by the character #.

Each successive non-comment row appends an additional layer to the hierarchy

The format of the configuration file is:
Column
1. Interesting Frame Detector selectivity
2. Interesting Frame Detector buffer length
3. Interesting Frame Detector feature vector layer name
4. Number of copies of microclassifier to make
5. Microclassifier feature vector crop window xmin
6. Microclassifier feature vector crop window ymin
7. Microclassifier feature vector crop window xmax
8. Microclassifier feature vector crop window ymax
9. "true" if the feature vector should be flattened to 1-dimenion, "false" otherwise
10. Path to the microclassifier model file
11. The threshold for the microclassifier output probability

Sample command to run FilterForward
apps/filterforward/filterforward -C ../config/ -f /path/to/filterforward/config/file -m name_of_fv_model --fields "image" -o /tmp/path/to/output/directory --camera name_of_camera --layer NAME_OF_LAYER

Run
apps/filterforward/filterforward -h
to see additional options such as batch size
